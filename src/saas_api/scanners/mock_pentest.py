from __future__ import annotations

from typing import Any, Dict

from .base import ScanAdapter


class MockPentestAdapter(ScanAdapter):
    name = "mock_pentest"

    def run(self, job: Dict[str, Any]) -> Dict[str, Any]:
        target = job.get("config", {}).get("target_url", "unknown")
        findings = [
            {
                "severity": "HIGH",
                "type": "Broken Access Control",
                "location": f"{target}/admin",
            },
            {
                "severity": "MEDIUM",
                "type": "Rate Limit Missing",
                "location": f"{target}/api/auth",
            },
        ]
        return {
            "scanner": self.name,
            "summary": {
                "total_findings": len(findings),
            },
            "findings": findings,
        }
